CREATE DATABASE TASK11
USE TASK11


CREATE TABLE STUDENTS(
SID INT,
SNAME VARCHAR(20),
DEPTARTMENT VARCHAR(20),
YOC INT
)

INSERT INTO STUDENTS VALUES(1,'HARISHMITHA','BCA',2023),
(2,'HARITHA','BCOM',2023),
(3,'POOJA','BCA',2022),
(4,'DINESH','BSCCS',2022),
(5,'ARJUN','BCA',2024),
(6,'SARAN','BCA',2022),
(7,'HARI','BCOM',2024),
(8,'MITHA','BCA',2024),
(9,'JANI','BCOM',2023),
(10,'RIYA','BCOM',2022),
(11,'ZAARA','BCOM',2023),
(12,'PRIYA','BSCCS',2022),
(13,'RANITA','BSCCS',2024),
(14,'YAMINI','BSCCS',2023),
(15,'ZIYA','BSCCS',2022),
(16,'ANGEL','BA',2024),
(17,'PRASATH','BA',2023),
(18,'RAJESH','BA',2023),
(19,'GOWTHAM','BA',2022),
(20,'POORNI','BA',2023)

SELECT * FROM STUDENTS

--Simplify the table to show the number of students in each department and categorize them based on yearofcompletion.

select sid ,DEPTARTMENT , YOC from (
SELECT YOC,BCA,BA,BSCCS,BCOM FROM (SELECT SID ,DEPTARTMENT,YOC FROM STUDENTS) AS T1
PIVOT
(
COUNT(SID) FOR DEPTARTMENT IN (BCA,BA,BSCCS,BCOM)
)AS T2
)AS T
UNPIVOT
(
SID for DEPTARTMENT  IN (BCA,BA,BSCCS,BCOM)
)AS P





